<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Hell's Kitchen</title>
        <script type="text/javascript" src="d3.js"></script>
        <style type="text/css">

			text {
				font-family: sans-serif;
				font-size: 12px;
				fill: white;
			}
            div.tooltip {	
                position: absolute;			
                text-align: center;			
                width: 80px;					
                height: 50px;					
                padding: 2px;				
                font: 12px sans-serif;		
                background: lightsteelblue;	
                border: 0px;		
                border-radius: 8px;			
                pointer-events: none;			
            }
            path {
              stroke: gray;
              stroke-width: 1px;
              stroke-linejoin: round;
              stroke-linecap: round;
            }
		</style>
    </head>
    <body>
         <div id="C">
            <h2>Hover the map with the mouse pointer to see the grade a chinese restaurant at that location is most likely to get.</h2>
            <script type="text/javascript">
                // D3 code will go here

                //Width and height
                var w = 960;
                var h = 960;

                //Define global data
                var activerat;
                var procon;

                //Define map projection
                var projection = d3.geo.mercator()
                            .center([-73.94, 40.70])
                            .scale(75000)
                            .translate([w/2, h/2]);

                //Define path generator
                var path = d3.geo.path()
                             .projection(projection);
                 var div = d3.select("body").append("div")	
                    .attr("class", "tooltip")				
                    .style("opacity", 0);

                //Define quantize scale to sort data values into buckets of color
           /*     q0 = "rgb(247,251,255)";
                q1 = "rgb(222,235,247)";
                q2 = "rgb(198,219,239)";
                q3 = "rgb(158,202,225)";
                q4 = "rgb(107,174,214)";
                q5 = "rgb(66,146,198)";
                q6 = "rgb(33,113,181)";
                q7 = "rgb(8,81,156)";
                q8 = "rgb(8,48,107)";
                var color = d3.scale.quantize()
                                    .range([q0,q1,q2,q3,q4,q5,q6,q7,q8]);*/

                //Create SVG element
                var svg = d3.select("#C")
                            .append("svg")
                            .attr("width", w)
                            .attr("height", h);

                //Load in rat inspection result data
               d3.text('ChinesePrediction.csv', function(error, _data){
                   if (error) throw(error);
                    //Load in GeoJSON data
                   var predictData = d3.csv.parseRows(_data);
                    d3.json("Zipcode_TabulationArea.geojson", function(error,json) {
                    if (error) throw(error);
                        console.log(predictData);
                  
                    svg.selectAll("path")
                       .data(json.features)
                       .enter()
                       .append("path")
                       .attr("d", path)
                       .style("fill", "#ccc");
                   
                    svg.selectAll(".pin")
                        .data(predictData)
                        .enter().append("circle", ".pin")
                        .attr("r", 4)
                        .attr("transform", function(d,i) {
                              return "translate(" + projection([
                                d[0],d[1]
                              ]) + ")";
                        })
                        .on("mouseover", function(d,i) {		
                            div.transition()		
                                .duration(200)		
                                .style("opacity", .9);		
                            div.html( "<br/>Likely grade:"  + d[2])	
                                .style("left", (d3.event.pageX) + "px")		
                                .style("top", (d3.event.pageY - 28) + "px");	
                        })					
                        .on("mouseout", function(d) {		
                            div.transition()		
                                .duration(500)		
                                .style("opacity", 0);	
                        })
                        .style("opacity", 0);
                 });
              //  })
               });

            </script>	    
        </div>
       <!-- <div id="E">
    <h2>Average score as a function of the ratio between active rat signs and the total number of inspections in each zip code</h2>
    <script type="text/javascript">


     /*   d3.csv("CrimeData.csv", function(error, data) {

            if (error) {  //If error is not null, something went wrong.
                console.log(error);  //Log the error.
            } else {      //The file loaded correctly
                dataSet = d3.csv.parseRows(_data);
                console.log(_data);
                console.log(scatterdata);
            }

});*/
        var yScale;
        var scatterdata;
        var padding = 20;
        var svg;
        d3.text('scoreVSrat.csv', function(error, _data){
            if (error) {  //If error is not null, something went wrong.
                console.log(error);  //Log the error.
            } 
            else {      //The file loaded correctly
                var scatterdata = d3.csv.parseRows(_data);
            }
        
                var w = 500;
                var h = 500;
                var twenty15 = false;
                
                var xScale = d3.scale.linear()
								 .domain([10, 20])
								 .range([padding*4, 500-padding*4]);

                yScale = d3.scale.linear()
								 .domain([0, 1])
								 .range([500-padding*4,padding*4]);
                
                var radScale = d3.scale.linear()
								 .domain([0, d3.max(scatterdata, function(d) { return d[1]; })])
								 .range([2, 5]);
                
                var xAxis = d3.svg.axis()
							  .scale(xScale)
							  .orient("bottom")
							  .ticks(5);

			     //Define Y axis
			     var yAxis = d3.svg.axis()
							  .scale(yScale)
							  .orient("left")
							  .ticks(5);

                //Create SVG element
                svg = d3.select("#E")
                            .append("svg")
                            .attr("width", w)
                            .attr("height", h);
                var tooltip = d3.select("#E").append("div")
                    .attr("class", "tooltip")
                    .style("opacity", 0);
            
                svg.selectAll("circle")
                   .data(scatterdata)
                   .enter()
                   .append("circle")
                   .attr("cx", function(d) {
                        return xScale(d[1]);
                   })
                   .attr("cy", function(d) {
                        return yScale(d[3]);
                   })
                   .attr("r", function(d) {
                        return 3;
                   })
                   .on("mouseover", function(d) {
                        tooltip.transition()
                        .durat1ion(200)
                        .style("opacity", .9);
                        tooltip.html(d[0] + "<br/> (" + d[1] + ", " + d[3] + ")")
                        .style("left", (d3.event.pageX + 5) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                    })
                    .on("mouseout", function(d) {
                        tooltip.transition()
                        .duration(500)
                        .style("opacity", 0);
                    });
            
                
              /*  svg.selectAll("text")
                   .data(scatterdata)
                   .enter()
                   .append("text")
                   .text(function(d) {
                        return d[0];
                   })
                   .attr("x", function(d) {
                        return xScale(d[1]);
                   })
                   .attr("y", function(d) {
                        return yScale(d[3]);
                   })
                   .attr("font-family", "sans-serif")
                   .attr("font-size", "11px")
                   .attr("fill", "red");*/

                svg.append("g")
                        .attr("class", "axis")
                        .attr("transform", "translate(0," + (h - padding*4) + ")")
                        .call(xAxis);
                svg.append("text")      // text label for the x axis
                        .attr("x", 265 )
                        .attr("y",  h-30 )
                        .style("text-anchor", "middle")
                        .text("Average grade");

//Create Y axis
                svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", "translate(" + padding*4 + ",0)")
                    .call(yAxis);
                svg.append("text")
                    .attr("text-anchor", "middle")  
                    .attr("transform", "translate("+ (padding) +","+(h/2)+")rotate(-90)")  
                    .text("active rat signs/total inspections");
                    });
               
    </script>
        </div>
        <div id="F">
    <h2>Average score as a function of the number of active ratsigns in each zip code</h2>
    <script type="text/javascript">


     /*   d3.csv("CrimeData.csv", function(error, data) {

            if (error) {  //If error is not null, something went wrong.
                console.log(error);  //Log the error.
            } else {      //The file loaded correctly
                dataSet = d3.csv.parseRows(_data);
                console.log(_data);
                console.log(scatterdata);
            }

});*/
        var yScale;
        var scatterdata;
        var padding = 20;
        var svg;
        d3.text('scoreVSrat.csv', function(error, _data){
            if (error) {  //If error is not null, something went wrong.
                console.log(error);  //Log the error.
            } 
            else {      //The file loaded correctly
                var scatterdata = d3.csv.parseRows(_data);
            }
        
                var w = 500;
                var h = 500;
                var twenty15 = false;
                
                var xScale = d3.scale.linear()
								 .domain([10, 20])
								 .range([padding*4, 500-padding*4]);

                yScale = d3.scale.linear()
								 .domain([0, 5000])
								 .range([500-padding*4,padding*4]);
                
                var radScale = d3.scale.linear()
								 .domain([0, d3.max(scatterdata, function(d) { return d[1]; })])
								 .range([2, 5]);
                
                var xAxis = d3.svg.axis()
							  .scale(xScale)
							  .orient("bottom")
							  .ticks(5);

			     //Define Y axis
			     var yAxis = d3.svg.axis()
							  .scale(yScale)
							  .orient("left")
							  .ticks(5);

                //Create SVG element
                svg = d3.select("#F")
                            .append("svg")
                            .attr("width", w)
                            .attr("height", h);

                svg.selectAll("circle")
                   .data(scatterdata)
                   .enter()
                   .append("circle")
                   .attr("cx", function(d) {
                        return xScale(d[1]);
                   })
                   .attr("cy", function(d) {
                        return yScale(d[2]);
                   })
                   .attr("r", function(d) {
                        return 3;
                   });

              /*  svg.selectAll("text")
                   .data(scatterdata)
                   .enter()
                   .append("text")
                   .text(function(d) {
                        return d[0];
                   })
                   .attr("x", function(d) {
                        return xScale(d[1]);
                   })
                   .attr("y", function(d) {
                        return yScale(d[3]);
                   })
                   .attr("font-family", "sans-serif")
                   .attr("font-size", "11px")
                   .attr("fill", "red");*/

                svg.append("g")
                        .attr("class", "axis")
                        .attr("transform", "translate(0," + (h - padding*4) + ")")
                        .call(xAxis);
                svg.append("text")      // text label for the x axis
                    .attr("x", 265 )
                    .attr("y",  h-30 )
                    .style("text-anchor", "middle")
                    .text("Average grade");
//Create Y axis
                svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", "translate(" + padding*4 + ",0)")
                    .call(yAxis);
            
                svg.append("text")
                    .attr("text-anchor", "middle")  
                    .attr("transform", "translate("+ (padding) +","+(h/2)+")rotate(-90)")  
                    .text("Active rat signs");
                    });
    </script>
        </div> -->
        <div id="B">
            <h2>Number of restaurants of each cuisine</h2>
            <script type="text/javascript">

                d3.text('NumberOfCuisines2.csv', function(error, _data){
                    if (error) {  //If error is not null, something went wrong.
                        console.log(error);  //Log the error.
                    } 
                    else {      //The file loaded correctly
                        var CuisineData = d3.csv.parseRows(_data);
                    }
                var values = [];
                var labels = [];
                var dataset = Data();
                console.log(values);
                //Width and height
                var w = 600;
                var h = 600;

                var outerRadius = w / 2;
                var innerRadius = w / 3;
                var arc = d3.svg.arc()
                                .innerRadius(innerRadius)
                                .outerRadius(outerRadius);

                var pie = d3.layout.pie();

                //Easy colors accessible via a 10-step ordinal scale
                var color = d3.scale.ordinal()
	                   .domain([1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84])
	                   .range(["#CF8F95", "#6843C5", "#B55A23", "#F7FB9B", "#0C4880", "#D4F649", "#BA10DE", "#694B46", "#F3EEF7", "#AF4F7C", "#F51EB5", "#77F98C", "#7E6CAA", "#29E07D", "#82CC14", "#809AF5", "#F7DE05", "#B8314E", "#C77A7F", "#7F14C3", "#9542F3", "#8EA6DB", "#B84FA9", "#D60407", "#4876C3",
"#969D98", "#116C74", "#83CC26", "#50D55D", "#D965F3", "#899172", "#A8415B", "#5DF1A2", "#802567", "#331991", "#C2A532", "#8EBCF0", "#85E779", "#909C5F", "#49353C", "#7FE152", "#4E1FA1", "#026EAD", "#73D103", "#14D590", "#200126", "#47456F", "#661D5B", "#ADF8FF", "#C0395D",
"#A7EA81", "#1C852F", "#58666C", "#209299", "#1695FF", "#2A7150", "#36DBCF", "#B1818E", "#DAF7C9", "#0EF93E", "#96908E", "#0B5D72", "#D2353C", "#416383", "#C82B25", "#ABC4B4", "#2C08A7", "#A79DDD", "#91E056", "#42E6D1", "#C8C9C8", "#EF5E7F", "#517FF4", "#C95AAB", "#0EDF5B",
"#023DB0", "#6A0B87", "#BE92D8", "#691C4C", "#85A540", "#05243E", "#498450", "#C1F53C", "#EA607B"]);

                //Create SVG element
                var svg = d3.select("#B")
                            .append("svg")
                            .attr("width", w)
                            .attr("height", h);

                //Set up groups
                var arcs = svg.selectAll("g.arc")
                              .data(pie(values))
                              .enter()
                              .append("g")
                              .attr("class", "arc")
                              .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")");

                //Draw arc paths
                var div = d3.select("body").append("div")	
                    .attr("class", "tooltip")				
                    .style("opacity", 0);

                arcs.append("path")
                    .attr("fill", function(d, i) {
                        return color(i);
                    })
                    .attr("d", arc)
                    .on("mouseover", function(d,i) {		
                        div.transition()		
                            .duration(200)		
                            .style("opacity", .9);		
                        div.html( labels[i]+ "<br/>"  + values[i])	
                            .style("left", (d3.event.pageX) + "px")		
                            .style("top", (d3.event.pageY - 28) + "px");	
                    })					
                    .on("mouseout", function(d) {		
                        div.transition()		
                            .duration(500)		
                            .style("opacity", 0);	
                    });
					
                function Data (){
                    var list = []

                    for (i = 0; i < 84; i++) {
                        list.push({label:CuisineData[i][0],value:parseFloat(CuisineData[i][2])});
                        values.push(parseFloat(CuisineData[i][1]));
                        labels.push(CuisineData[i][0]);
                    }
                    console.log(list);
                    return list;
                    } 
                });

            </script>
        </div>
       
    </body>
</html>